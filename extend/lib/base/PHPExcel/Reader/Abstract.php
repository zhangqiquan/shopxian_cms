<?php 

           /**
            * 秀仙系统 shopxian_release/3.0.0
            * ============================================================================
            * * 版权所有 2017-2018 上海秀仙网络科技有限公司，并保留所有权利。
            * 网站地址: http://www.shopxian.com；
            * ----------------------------------------------------------------------------
            * 本软件只能免费使用  不允许对程序代码以任何形式任何目的再发布或者出售。
            * ============================================================================
            * 作者: 张启全 

            * 时间: 2018-03-11 18:25:10
            */
             abstract class PHPExcel_Reader_Abstract implements PHPExcel_Reader_IReader  {            protected $readDataOnly = false;              protected $readEmptyCells = true;              protected $includeCharts = false;              protected $loadSheetsOnly;              protected $readFilter;        protected $fileHandle = null;                public function getReadDataOnly()      {          return $this->readDataOnly;      }              public function setReadDataOnly($pValue = false)      {          $this->readDataOnly = $pValue;          return $this;      }              public function getReadEmptyCells()      {          return $this->readEmptyCells;      }              public function setReadEmptyCells($pValue = true)      {          $this->readEmptyCells = $pValue;          return $this;      }              public function getIncludeCharts()      {          return $this->includeCharts;      }              public function setIncludeCharts($pValue = false)      {          $this->includeCharts = (boolean) $pValue;          return $this;      }              public function getLoadSheetsOnly()      {          return $this->loadSheetsOnly;      }              public function setLoadSheetsOnly($value = null)      {          if ($value === null) {              return $this->setLoadAllSheets();          }            $this->loadSheetsOnly = is_array($value) ? $value : array($value);          return $this;      }              public function setLoadAllSheets()      {          $this->loadSheetsOnly = null;          return $this;      }              public function getReadFilter()      {          return $this->readFilter;      }              public function setReadFilter(PHPExcel_Reader_IReadFilter $pValue)      {          $this->readFilter = $pValue;          return $this;      }              protected function openFile($pFilename)      {                   if (!file_exists($pFilename) || !is_readable($pFilename)) {              throw new PHPExcel_Reader_Exception("Could not open " . $pFilename . " for reading! File does not exist.");          }                     $this->fileHandle = fopen($pFilename, 'r');          if ($this->fileHandle === false) {              throw new PHPExcel_Reader_Exception("Could not open file " . $pFilename . " for reading.");          }      }              public function canRead($pFilename)      {                   try {              $this->openFile($pFilename);          } catch (Exception $e) {              return false;          }            $readable = $this->isValidFormat();          fclose($this->fileHandle);          return $readable;      }              public function securityScan($xml)      {          $pattern = '/\\0?' . implode('\\0?', str_split('<!DOCTYPE')) . '\\0?/';          if (preg_match($pattern, $xml)) {              throw new PHPExcel_Reader_Exception('Detected use of ENTITY in XML, spreadsheet file load() aborted to prevent XXE/XEE attacks');          }          return $xml;      }              public function securityScanFile($filestream)      {          return $this->securityScan(file_get_contents($filestream));      }  }  